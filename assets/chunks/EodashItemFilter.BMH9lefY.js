import{useSTAcStore as v}from"@/store/stac";import"@eox/itemfilter";import{p as M,v as B,as as C,o as R,c as H,j as x,t as S,K as E}from"./framework.Gv4KJFRr.js";const T={slot:"filterstitle",style:{margin:"14px 8px"}},V={slot:"resultstitle",style:{margin:"14px 8px"}},h="float:right; height:15px; padding:4px;  margin-top:-4px; background-color:white;",k="float:right; height:15px; padding:4px;  margin-top:-4px; background-color:#9bcaeb;",I={__name:"EodashItemFilter",props:{enableCompare:{type:Boolean,default:!1},filtersTitle:{type:String,default:"Indicators"},resultsTitle:{type:String,default:""},titleProperty:{type:String,default:"title"},aggregateResults:{type:String,default:"themes"},enableHighlighting:{type:Boolean,default:!0},expandMultipleFilters:{type:Boolean,default:!0},expandMultipleResults:{type:Boolean,default:!0},filterProperties:{type:Array,default:()=>[{keys:["title","themes","description"],title:"Search",type:"text"},{key:"themes",title:"Theme Filter",type:"multiselect"}]}},setup(d){const r=d,w={titleProperty:r.titleProperty,filterProperties:r.filterProperties,aggregateResults:r.aggregateResults,enableHighlighting:r.enableHighlighting,expandMultipleFilters:r.expandMultipleFilters,expandMultipleResults:r.expandMultipleResults},a=M(null),n=v(),b=async i=>{var l,t;(t=(l=a.value)==null?void 0:l.shadowRoot)==null||t.querySelectorAll(".compareMapButton").forEach(o=>o.setAttribute("style",h));const e=i.detail;e?(n.resetSelectedCompareSTAC(),await n.loadSelectedSTAC(e.href)):n.selectedStac=null},A=()=>{setTimeout(()=>{var i,e;(i=a.value)==null||i.shadowRoot.querySelectorAll("details>summary").forEach(l=>l.setAttribute("style","width: 100%")),(e=a.value)==null||e.shadowRoot.querySelectorAll("details>div li").forEach(l=>{let t=document.createElement("button");t.className="compareMapButton",t.dataset.id=l.children[0].id,t.onclick=async c=>{var m,f,y;(f=(m=a.value)==null?void 0:m.shadowRoot)==null||f.querySelectorAll(".compareMapButton").forEach(u=>{u.setAttribute("style",h)});const p=c.currentTarget;p==null||p.setAttribute("style",k);const g=(y=a.value)==null?void 0:y.items.find(u=>u.id===(p==null?void 0:p.dataset.id));g&&await n.loadSelectedCompareSTAC(g.href)},t.setAttribute("style",h);const o=document.createElementNS("http://www.w3.org/2000/svg","svg"),s=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("width","15"),o.setAttribute("height","15"),o.setAttribute("viewBox","0 0 24 24"),s.setAttribute("d","M19,3H14V5H19V18L14,12V21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M10,18H5L10,12M10,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H10V23H12V1H10V3Z"),o.appendChild(s),t.appendChild(o),l.append(t)})},100)};return B(()=>{var l,t,o;const i=document.createElement("style");i.innerHTML=`
  section {
    margin: 0 !important;
    }
    section button#filter-reset {
      padding: 0 8px;
      top: 8px;
      right: 8px;
      }
      `,(t=(l=a.value)==null?void 0:l.shadowRoot)==null||t.appendChild(i);const e=(o=n.stac)==null?void 0:o.filter(s=>s.rel==="child").map(s=>C(s));e&&(a.value.items=e,a.value.selectedResult=e==null?void 0:e.find(s=>{var c;return s.id===((c=n.selectedStac)==null?void 0:c.id)}),r.enableCompare&&A())}),(i,e)=>(R(),H("eox-itemfilter",E({class:"fill-height"},w,{ref_key:"eoxItemFilter",ref:a,style:{overflow:"auto"},onSelect:b}),[x("h4",T,S(d.filtersTitle),1),x("h4",V,S(d.resultsTitle),1)],16))}};export{I as default};
